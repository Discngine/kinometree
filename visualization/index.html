<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 0;
}

#show-length {
  position: absolute;
  top: 10px;
  left: 10px;
}

.links {
  fill: none;
  stroke: #000;
}

.link-extensions {
  fill: none;
  stroke: #000;
  stroke-opacity: .25;
}

.labels {
  font: 4px sans-serif;
}

.link--active {
  stroke: #000 !important;
  stroke-width: 1.5px;
}

.link-extension--active {
  stroke-opacity: .6;
}

.label--active {
  font-weight: bold;
}

.click-circle {
    fill: steelblue;
}
.alignleft {
	float: left;
}
.alignright {
	float: right;
}

</style>
<div class="alignleft">
<label id="show-length">
  <input type="checkbox"> Show branch length
  <br>
  active<br>
  <textarea id="selection" rows="4" cols="20"></textarea>
  <br>inactive<br>
  <textarea id="inactive" rows="4" cols="20"></textarea>
  <br>unknown<br>
  <textarea id="unknown" rows="4" cols="20"></textarea>
  <br>
    Active Enrichment Json
  <br>
  <textarea id="unknown" rows="4" cols="20"></textarea>
  <a href="#" onclick="selectKinases()">Select</a>
</label>
</div>

<div id="d3div" class="alignright">
</div>


<!-- Copyright 2011 Jason Davies https://github.com/jasondavies/newick.js -->
<script>function parseNewick(a){for(var e=[],r={},s=a.split(/\s*(;|\(|\)|,|:)\s*/),t=0;t<s.length;t++){var n=s[t];switch(n){case"(":var c={};r.branchset=[c],e.push(r),r=c;break;case",":var c={};e[e.length-1].branchset.push(c),r=c;break;case")":r=e.pop();break;case":":break;default:var h=s[t-1];")"==h||"("==h||","==h?r.name=n:":"==h&&(r.length=parseFloat(n))}}return r}</script>

<!-- Copyright 2016 Mike Bostock https://d3js.org -->
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

//var efdata = JSON.parse("ef.json");
var outerRadius = 960 / 2,
    innerRadius = outerRadius - 170;

var color = d3.scaleOrdinal()
    .domain(["AGC", "Atypical", "CAMK","CK1","CMGC","Other","RGC","STE","TK","TKL"])
    .range(["#006ddb","#490092","#ffb6db","#009292","#004949","#ff6db6","#b6dbff","#6db6ff","#b66dff","#7A9E9C"]);
    //.range(d3.schemeCategory10);

var efcolorActives = d3.scaleLinear().domain([-0.5,0.0,1.0])
  .range(["grey", "yellow","green"])

var efcolorInactives = d3.scaleLinear().domain([-0.5,0.0,1.0])
  .range(["grey", "yellow","red"])



var cluster = d3.cluster()
    .size([360, innerRadius])
    .separation(function(a, b) { return 1; });

var svg = d3.select("#d3div").append("svg")
    .attr("width", outerRadius * 2)
    .attr("height", outerRadius * 2)
    .call(d3.zoom()
    .scaleExtent([1 / 2, 8])
    .on("zoom", zoomed));

    var chart = svg.append("g");
    transform = d3.zoomIdentity;



    function zoomed() {
      chart.attr("transform", d3.event.transform);
    }

    function dragged(d) {
      d3.select(this).attr("cx", d.x = d3.event.x).attr("cy", d.y = d3.event.y);
    }


    /*.call(d3.zoom().on("zoom", function () {
            svg.attr("transform", d3.event.transform)
        }));*/


var legend = svg.append("g")
    .attr("class", "legend")
  .selectAll("g")
  .data(color.domain())
  .enter().append("g")
    .attr("transform", function(d, i) { return "translate(" + (outerRadius * 2 - 10) + "," + (i * 20 + 10) + ")"; })    ;


legend.append("rect")
    .attr("x", -18)
    .attr("width", 18)
    .attr("height", 18)
    .attr("fill", color);

legend.append("text")
    .attr("x", -24)
    .attr("y", 9)
    .attr("dy", ".35em")
    .attr("text-anchor", "end")
    .text(function(d) { return d; });


    //.attr("transform", "translate(" + outerRadius + "," + outerRadius + ")");
efjson=JSON.parse('{"Inner25": [-0.26859504132231404, 1.0, 2], "Inner206": [-0.26859504132231404, 1.0, 3], "Inner423": [-0.26859504132231404, 1.0, 4], "Inner195": [-0.26859504132231404, -3.7230769230769245, 2], "Inner196": [-0.26859504132231404, -3.7230769230769245, 2], "Inner374": [-0.26859504132231404, -3.7230769230769245, 4], "Inner119": [-0.26859504132231404, 1.0, 2], "Inner194": [-0.26859504132231404, 1.0, 3], "Inner227": [-0.26859504132231404, 1.0, 2], "Inner283": [-0.26859504132231404, 1.0, 5], "Inner305": [-0.26859504132231404, 1.0, 6], "Inner373": [-0.26859504132231404, 1.0, 7], "Inner437": [-0.26859504132231404, 1.0, 11], "Inner99": [1.0, -3.7230769230769245, 2], "Inner170": [1.0, -3.7230769230769245, 3], "Inner269": [1.0, -3.7230769230769245, 4], "Inner260": [-0.26859504132231404, 1.0, 2], "Inner264": [-0.26859504132231404, 1.0, 3], "Inner313": [-0.26859504132231404, 1.0, 4], "Inner431": [0.15426997245179055, -0.5743589743589751, 8], "Inner113": [-0.26859504132231404, 1.0, 2], "Inner165": [-0.26859504132231404, 1.0, 3], "Inner112": [-0.26859504132231404, 1.0, 2], "Inner204": [-0.26859504132231404, 1.0, 3], "Inner104": [-0.26859504132231404, -3.7230769230769245, 2], "Inner254": [-0.26859504132231404, 1.0, 3], "Inner304": [-0.26859504132231404, 1.0, 6], "Inner398": [-0.26859504132231404, 1.0, 9], "Inner438": [-0.12764003673094584, 0.4752136752136754, 17], "Inner462": [-0.17798110979929163, 0.6626373626373628, 28], "Inner473": [-0.19397180359747207, 0.7221719457013577, 32], "Inner75": [-0.26859504132231404, -3.7230769230769245, 2], "Inner197": [-0.26859504132231404, -3.7230769230769245, 3], "Inner425": [-0.26859504132231404, -3.7230769230769245, 4], "Inner47": [-0.26859504132231404, 1.0, 2], "Inner324": [-0.26859504132231404, 1.0, 3], "Inner220": [-0.26859504132231404, 1.0, 2], "Inner43": [-0.26859504132231404, -3.7230769230769245, 2], "Inner219": [-0.26859504132231404, -3.7230769230769245, 3], "Inner375": [-0.26859504132231404, 1.0, 5], "Inner430": [-0.26859504132231404, 1.0, 8], "Inner467": [-0.26859504132231404, 1.0, 12], "Inner332": [-0.26859504132231404, 1.0, 2], "Inner100": [-0.26859504132231404, 1.0, 2], "Inner378": [-0.26859504132231404, 1.0, 3], "Inner476": [-0.26859504132231404, 1.0, 5], "Inner277": [-0.26859504132231404, 1.0, 2], "Inner323": [-0.26859504132231404, 1.0, 3], "Inner405": [-0.26859504132231404, 1.0, 4], "Inner416": [-0.26859504132231404, 1.0, 5], "Inner30": [-0.26859504132231404, 1.0, 2], "Inner372": [-0.26859504132231404, 1.0, 3], "Inner120": [-0.26859504132231404, 1.0, 2], "Inner121": [-0.26859504132231404, 1.0, 3], "Inner276": [-0.26859504132231404, 1.0, 4], "Inner461": [-0.26859504132231404, 1.0, 7], "Inner116": [0.365702479338843, -1.3615384615384623, 2], "Inner364": [0.15426997245179055, -0.5743589743589751, 3], "Inner230": [-0.26859504132231404, 1.0, 2], "Inner274": [-0.26859504132231404, 1.0, 3], "Inner340": [-0.26859504132231404, 1.0, 4], "Inner272": [-0.26859504132231404, 1.0, 2], "Inner273": [-0.26859504132231404, 1.0, 3], "Inner101": [-0.26859504132231404, -3.7230769230769245, 2], "Inner339": [-0.26859504132231404, 1.0, 5], "Inner381": [-0.26859504132231404, 1.0, 9], "Inner412": [-0.12764003673094584, 0.4752136752136754, 12], "Inner349": [1.0, -3.7230769230769245, 2], "Inner433": [-0.014876033057851235, 0.055384615384615386, 14], "Inner468": [-0.11934856587263007, 0.44434389140271535, 21], "Inner469": [-0.14173553719008264, 0.5276923076923077, 26], "Inner167": [-0.26859504132231404, 1.0, 2], "Inner180": [-0.26859504132231404, 1.0, 3], "Inner78": [-0.26859504132231404, 1.0, 2], "Inner79": [-0.26859504132231404, 1.0, 3], "Inner153": [-0.26859504132231404, 1.0, 4], "Inner389": [-0.26859504132231404, 1.0, 7], "Inner275": [-0.26859504132231404, 1.0, 2], "Inner356": [-0.26859504132231404, 1.0, 3], "Inner200": [-0.26859504132231404, 1.0, 2], "Inner406": [-0.26859504132231404, 1.0, 5], "Inner69": [-0.26859504132231404, 1.0, 2], "Inner129": [-0.26859504132231404, 1.0, 2], "Inner351": [-0.26859504132231404, 1.0, 4], "Inner95": [0.15426997245179055, -0.5743589743589751, 2], "Inner147": [0.04855371900826447, -0.18076923076923077, 3], "Inner198": [-0.014876033057851235, 0.055384615384615386, 4], "Inner377": [-0.12764003673094584, 0.4752136752136754, 8], "Inner199": [-0.26859504132231404, -3.7230769230769245, 2], "Inner282": [0.365702479338843, -1.3615384615384623, 3], "Inner261": [-0.26859504132231404, 1.0, 2], "Inner352": [0.04855371900826447, -0.18076923076923077, 5], "Inner287": [-0.26859504132231404, 1.0, 2], "Inner98": [-0.26859504132231404, -3.7230769230769245, 2], "Inner140": [-0.26859504132231404, -3.7230769230769245, 2], "Inner163": [-0.26859504132231404, -3.7230769230769245, 4], "Inner293": [-0.26859504132231404, 1.0, 5], "Inner310": [-0.26859504132231404, 1.0, 7], "Inner259": [-0.26859504132231404, 1.0, 2], "Inner350": [-0.26859504132231404, 1.0, 3], "Inner353": [-0.26859504132231404, 1.0, 4], "Inner404": [-0.26859504132231404, 1.0, 11], "Inner414": [-0.11002066115702479, 0.40961538461538444, 16], "Inner420": [-0.11934856587263007, 0.44434389140271535, 24], "Inner460": [-0.14777646595828414, 0.5501831501831502, 29], "Inner271": [-0.26859504132231404, 1.0, 2], "Inner262": [-0.26859504132231404, 1.0, 2], "Inner263": [-0.26859504132231404, 1.0, 3], "Inner270": [-0.26859504132231404, 1.0, 4], "Inner308": [-0.26859504132231404, 1.0, 6], "Inner189": [-0.26859504132231404, 1.0, 2], "Inner190": [-0.26859504132231404, 1.0, 3], "Inner242": [-0.26859504132231404, 1.0, 4], "Inner290": [-0.26859504132231404, 1.0, 5], "Inner329": [-0.26859504132231404, 1.0, 6], "Inner363": [-0.26859504132231404, 1.0, 12], "Inner52": [-0.26859504132231404, 1.0, 2], "Inner20": [-0.26859504132231404, 1.0, 2], "Inner45": [-0.26859504132231404, 1.0, 3], "Inner91": [-0.26859504132231404, 1.0, 4], "Inner139": [-0.26859504132231404, 1.0, 2], "Inner203": [-0.26859504132231404, 1.0, 6], "Inner164": [-0.26859504132231404, 1.0, 2], "Inner241": [-0.26859504132231404, 1.0, 3], "Inner288": [-0.26859504132231404, 1.0, 9], "Inner309": [-0.26859504132231404, 1.0, 11], "Inner415": [-0.26859504132231404, 1.0, 23], "Inner22": [-0.26859504132231404, -3.7230769230769245, 2], "Inner122": [-0.26859504132231404, -3.7230769230769245, 3], "Inner11": [-0.26859504132231404, -3.7230769230769245, 2], "Inner74": [-0.26859504132231404, -3.7230769230769245, 3], "Inner225": [-0.26859504132231404, -3.7230769230769245, 6], "Inner298": [-0.26859504132231404, 1.0, 7], "Inner422": [-0.26859504132231404, 1.0, 30], "Inner470": [-0.2081857536402991, 0.7750915750915747, 59], "Inner19": [-0.26859504132231404, 1.0, 2], "Inner13": [-0.26859504132231404, 1.0, 2], "Inner16": [-0.26859504132231404, 1.0, 3], "Inner28": [-0.26859504132231404, 1.0, 4], "Inner92": [-0.26859504132231404, 1.0, 5], "Inner201": [-0.26859504132231404, 1.0, 7], "Inner280": [0.15426997245179055, -0.5743589743589751, 2], "Inner17": [0.04855371900826447, -0.18076923076923077, 2], "Inner361": [-0.014876033057851235, 0.055384615384615386, 4], "Inner459": [-0.14173553719008264, 0.5276923076923077, 11], "Inner475": [-0.19540686586141132, 0.7275147928994082, 70], "Inner478": [-0.20409020871270486, 0.7598435462842242, 77], "Inner479": [-0.1883042159221676, 0.7010710808179162, 103], "Inner151": [-0.26859504132231404, 1.0, 2], "Inner38": [-0.26859504132231404, 1.0, 2], "Inner111": [-0.26859504132231404, 1.0, 3], "Inner307": [-0.26859504132231404, 1.0, 4], "Inner80": [-0.26859504132231404, 1.0, 2], "Inner81": [-0.26859504132231404, 1.0, 3], "Inner235": [-0.26859504132231404, 1.0, 4], "Inner426": [-0.26859504132231404, 1.0, 8], "Inner451": [-0.26859504132231404, 1.0, 10], "Inner322": [-0.26859504132231404, 1.0, 2], "Inner362": [-0.26859504132231404, 1.0, 3], "Inner368": [-0.26859504132231404, 1.0, 4], "Inner380": [-0.26859504132231404, 1.0, 5], "Inner236": [-0.26859504132231404, 1.0, 2], "Inner237": [-0.26859504132231404, 1.0, 3], "Inner185": [-0.26859504132231404, -3.7230769230769245, 2], "Inner325": [-0.26859504132231404, 1.0, 5], "Inner314": [-0.26859504132231404, 1.0, 2], "Inner315": [-0.26859504132231404, 1.0, 3], "Inner316": [-0.26859504132231404, 1.0, 4], "Inner317": [-0.26859504132231404, 1.0, 5], "Inner318": [-0.26859504132231404, 1.0, 6], "Inner319": [-0.26859504132231404, 1.0, 7], "Inner382": [-0.26859504132231404, 1.0, 12], "Inner428": [-0.26859504132231404, 1.0, 17], "Inner61": [-0.26859504132231404, 1.0, 2], "Inner258": [-0.26859504132231404, 1.0, 3], "Inner320": [-0.26859504132231404, 1.0, 4], "Inner410": [-0.26859504132231404, 1.0, 5], "Inner472": [-0.26859504132231404, 1.0, 22], "Inner480": [-0.26859504132231404, 1.0, 32], "Inner393": [-0.26859504132231404, -3.7230769230769245, 2], "Inner291": [-0.26859504132231404, 1.0, 2], "Inner358": [-0.26859504132231404, 1.0, 3], "Inner477": [-0.26859504132231404, 1.0, 5], "Inner62": [-0.26859504132231404, 1.0, 2], "Inner142": [-0.26859504132231404, 1.0, 3], "Inner87": [0.365702479338843, -1.3615384615384623, 2], "Inner268": [0.15426997245179055, -0.5743589743589751, 3], "Inner397": [-0.057162534435261744, 0.2128205128205131, 6], "Inner446": [-0.057162534435261744, 0.2128205128205131, 7], "Inner85": [0.365702479338843, -1.3615384615384623, 2], "Inner301": [0.5771349862258952, -2.14871794871795, 3], "Inner217": [-0.26859504132231404, 1.0, 2], "Inner441": [0.365702479338843, -1.3615384615384623, 5], "Inner452": [0.11198347107438011, -0.41692307692307734, 12], "Inner481": [0.07738542449286248, -0.28811188811188804, 17], "Inner134": [-0.26859504132231404, 1.0, 2], "Inner338": [0.365702479338843, -1.3615384615384623, 3], "Inner57": [-0.26859504132231404, 1.0, 2], "Inner179": [-0.26859504132231404, 1.0, 3], "Inner284": [-0.26859504132231404, -3.7230769230769245, 2], "Inner106": [1.0, -3.7230769230769245, 2], "Inner218": [1.0, -3.7230769230769245, 3], "Inner343": [1.0, -3.7230769230769245, 5], "Inner171": [0.5771349862258952, -2.14871794871795, 2], "Inner345": [0.7462809917355372, -2.77846153846154, 7], "Inner202": [1.0, -3.7230769230769245, 2], "Inner154": [0.5771349862258952, -2.14871794871795, 2], "Inner285": [0.6828512396694214, -2.5423076923076935, 3], "Inner294": [0.6828512396694214, -2.5423076923076935, 4], "Inner346": [0.7462809917355372, -2.77846153846154, 6], "Inner21": [-0.26859504132231404, 1.0, 2], "Inner54": [0.365702479338843, -1.3615384615384623, 3], "Inner184": [0.15426997245179055, -0.5743589743589751, 4], "Inner138": [-0.26859504132231404, -3.7230769230769245, 2], "Inner289": [-0.26859504132231404, -3.7230769230769245, 3], "Inner311": [0.15426997245179055, -0.5743589743589751, 7], "Inner385": [0.5242768595041322, -1.951923076923078, 13], "Inner390": [0.6540195341848234, -2.434965034965036, 20], "Inner413": [0.5120788302606484, -1.906508875739646, 23], "Inner457": [0.49256198347107427, -1.8338461538461546, 26], "Inner90": [-0.26859504132231404, 1.0, 2], "Inner383": [-0.26859504132231404, 1.0, 3], "Inner292": [0.365702479338843, -1.3615384615384623, 2], "Inner335": [1.0, -3.7230769230769245, 2], "Inner394": [1.0, -3.7230769230769245, 3], "Inner330": [-0.26859504132231404, -3.7230769230769245, 2], "Inner403": [1.0, -3.7230769230769245, 5], "Inner445": [0.5771349862258952, -2.14871794871795, 7], "Inner449": [0.23884297520661157, -0.8892307692307696, 10], "Inner63": [0.365702479338843, -1.3615384615384623, 2], "Inner64": [0.15426997245179055, -0.5743589743589751, 3], "Inner86": [0.04855371900826447, -0.18076923076923077, 4], "Inner102": [-0.26859504132231404, -3.7230769230769245, 2], "Inner193": [-0.26859504132231404, -3.7230769230769245, 3], "Inner296": [0.04855371900826447, -0.18076923076923077, 7], "Inner369": [0.04855371900826447, -0.18076923076923077, 8], "Inner148": [-0.26859504132231404, 1.0, 2], "Inner240": [-0.26859504132231404, 1.0, 3], "Inner58": [-0.26859504132231404, 1.0, 2], "Inner59": [-0.26859504132231404, 1.0, 3], "Inner124": [1.0, -3.7230769230769245, 2], "Inner133": [1.0, -3.7230769230769245, 2], "Inner108": [1.0, -3.7230769230769245, 2], "Inner172": [1.0, -3.7230769230769245, 3], "Inner215": [1.0, -3.7230769230769245, 5], "Inner245": [1.0, -3.7230769230769245, 7], "Inner297": [0.8187721369539551, -3.0483516483516495, 10], "Inner384": [0.6828512396694214, -2.5423076923076935, 13], "Inner399": [0.4714187327823691, -1.7551282051282058, 21], "Inner55": [-0.26859504132231404, -3.7230769230769245, 2], "Inner24": [-0.26859504132231404, -3.7230769230769245, 2], "Inner31": [-0.26859504132231404, -3.7230769230769245, 3], "Inner73": [-0.26859504132231404, -3.7230769230769245, 4], "Inner212": [-0.26859504132231404, -3.7230769230769245, 6], "Inner327": [1.0, -3.7230769230769245, 2], "Inner402": [1.0, -3.7230769230769245, 8], "Inner434": [0.5120788302606484, -1.906508875739646, 29], "Inner50": [-0.26859504132231404, 1.0, 2], "Inner51": [-0.26859504132231404, 1.0, 3], "Inner93": [-0.26859504132231404, 1.0, 2], "Inner94": [0.365702479338843, -1.3615384615384623, 3], "Inner128": [0.5771349862258952, -2.14871794871795, 4], "Inner246": [0.15426997245179055, -0.5743589743589751, 7], "Inner247": [1.0, -3.7230769230769245, 2], "Inner141": [0.6828512396694214, -2.5423076923076935, 2], "Inner348": [0.7885674931129476, -2.9358974358974375, 4], "Inner387": [0.4714187327823691, -1.7551282051282058, 11], "Inner211": [-0.26859504132231404, 1.0, 2], "Inner359": [-0.26859504132231404, 1.0, 3], "Inner191": [-0.26859504132231404, 1.0, 2], "Inner60": [-0.26859504132231404, 1.0, 2], "Inner286": [-0.26859504132231404, 1.0, 4], "Inner386": [-0.26859504132231404, 1.0, 7], "Inner161": [-0.26859504132231404, -3.7230769230769245, 2], "Inner15": [-0.26859504132231404, -3.7230769230769245, 2], "Inner169": [-0.26859504132231404, -3.7230769230769245, 3], "Inner233": [-0.26859504132231404, -3.7230769230769245, 2], "Inner344": [-0.26859504132231404, -3.7230769230769245, 5], "Inner391": [-0.26859504132231404, -3.7230769230769245, 7], "Inner411": [-0.26859504132231404, 1.0, 14], "Inner435": [0.32341597796143245, -1.2041025641025647, 25], "Inner126": [0.365702479338843, -1.3615384615384623, 2], "Inner127": [0.5771349862258952, -2.14871794871795, 3], "Inner302": [0.365702479338843, -1.3615384615384623, 4], "Inner41": [0.365702479338843, -1.3615384615384623, 2], "Inner131": [0.5771349862258952, -2.14871794871795, 3], "Inner295": [0.5771349862258952, -2.14871794871795, 4], "Inner216": [1.0, -3.7230769230769245, 2], "Inner331": [0.7462809917355372, -2.77846153846154, 6], "Inner396": [0.5771349862258952, -2.14871794871795, 10], "Inner82": [1.0, -3.7230769230769245, 2], "Inner228": [0.5771349862258952, -2.14871794871795, 3], "Inner88": [1.0, -3.7230769230769245, 2], "Inner89": [1.0, -3.7230769230769245, 3], "Inner342": [0.7885674931129476, -2.9358974358974375, 6], "Inner35": [-0.26859504132231404, -3.7230769230769245, 2], "Inner123": [-0.26859504132231404, -3.7230769230769245, 3], "Inner132": [-0.26859504132231404, -3.7230769230769245, 4], "Inner36": [1.0, -3.7230769230769245, 2], "Inner37": [1.0, -3.7230769230769245, 3], "Inner65": [-0.26859504132231404, -3.7230769230769245, 2], "Inner125": [1.0, -3.7230769230769245, 5], "Inner312": [1.0, -3.7230769230769245, 9], "Inner152": [1.0, -3.7230769230769245, 2], "Inner234": [1.0, -3.7230769230769245, 2], "Inner250": [1.0, -3.7230769230769245, 4], "Inner347": [1.0, -3.7230769230769245, 13], "Inner400": [0.8846731780616077, -3.293706293706295, 19], "Inner444": [0.7462809917355372, -2.77846153846154, 29], "Inner448": [0.5650531286894923, -2.1037362637362644, 54], "Inner450": [0.5311713977721882, -1.9775919732441483, 83], "Inner456": [0.5025117485010532, -1.8708898944193069, 93], "Inner465": [0.5002504382669671, -1.8624708624708635, 119], "Inner482": [0.43984115058495216, -1.6375624375624387, 136], "Inner484": [0.2880333951762523, -1.0723704866562016, 168], "Inner278": [-0.26859504132231404, 1.0, 2], "Inner248": [-0.26859504132231404, 1.0, 2], "Inner419": [-0.26859504132231404, 1.0, 4], "Inner177": [-0.26859504132231404, 1.0, 2], "Inner231": [-0.26859504132231404, 1.0, 3], "Inner367": [-0.26859504132231404, 1.0, 4], "Inner96": [-0.26859504132231404, 1.0, 2], "Inner97": [-0.26859504132231404, 1.0, 3], "Inner130": [-0.26859504132231404, 1.0, 4], "Inner366": [-0.26859504132231404, 1.0, 5], "Inner418": [-0.26859504132231404, 1.0, 6], "Inner162": [-0.26859504132231404, 1.0, 2], "Inner143": [-0.26859504132231404, -3.7230769230769245, 2], "Inner144": [-0.26859504132231404, -3.7230769230769245, 3], "Inner145": [-0.26859504132231404, -3.7230769230769245, 4], "Inner279": [-0.26859504132231404, 1.0, 6], "Inner255": [-0.26859504132231404, -3.7230769230769245, 2], "Inner401": [-0.26859504132231404, 1.0, 8], "Inner453": [-0.26859504132231404, 1.0, 14], "Inner454": [-0.26859504132231404, 1.0, 18], "Inner463": [-0.26859504132231404, 1.0, 22], "Inner114": [-0.26859504132231404, 1.0, 2], "Inner370": [0.365702479338843, -1.3615384615384623, 2], "Inner436": [0.04855371900826447, -0.18076923076923077, 4], "Inner56": [-0.26859504132231404, -3.7230769230769245, 2], "Inner210": [-0.26859504132231404, 1.0, 2], "Inner158": [-0.26859504132231404, -3.7230769230769245, 2], "Inner159": [-0.26859504132231404, -3.7230769230769245, 3], "Inner160": [-0.26859504132231404, -3.7230769230769245, 4], "Inner357": [-0.26859504132231404, 1.0, 6], "Inner354": [-0.26859504132231404, 1.0, 2], "Inner421": [-0.26859504132231404, 1.0, 8], "Inner439": [-0.26859504132231404, 1.0, 10], "Inner455": [-0.057162534435261744, 0.2128205128205131, 14], "Inner214": [-0.26859504132231404, -3.7230769230769245, 2], "Inner157": [-0.26859504132231404, -3.7230769230769245, 2], "Inner407": [-0.26859504132231404, -3.7230769230769245, 4], "Inner178": [-0.26859504132231404, 1.0, 2], "Inner173": [-0.26859504132231404, 1.0, 2], "Inner174": [-0.26859504132231404, 1.0, 3], "Inner336": [-0.26859504132231404, 1.0, 5], "Inner103": [-0.26859504132231404, -3.7230769230769245, 2], "Inner166": [-0.26859504132231404, -3.7230769230769245, 3], "Inner66": [-0.26859504132231404, -3.7230769230769245, 2], "Inner175": [-0.26859504132231404, 1.0, 3], "Inner249": [-0.26859504132231404, 1.0, 4], "Inner67": [-0.26859504132231404, -3.7230769230769245, 2], "Inner68": [-0.26859504132231404, -3.7230769230769245, 3], "Inner40": [-0.26859504132231404, 1.0, 2], "Inner84": [-0.26859504132231404, 1.0, 3], "Inner281": [-0.26859504132231404, 1.0, 6], "Inner337": [-0.26859504132231404, 1.0, 10], "Inner371": [-0.26859504132231404, 1.0, 13], "Inner427": [-0.26859504132231404, 1.0, 18], "Inner440": [-0.26859504132231404, 1.0, 22], "Inner135": [-0.26859504132231404, 1.0, 2], "Inner136": [-0.26859504132231404, 1.0, 3], "Inner137": [-0.26859504132231404, 1.0, 4], "Inner70": [-0.26859504132231404, 1.0, 2], "Inner107": [-0.26859504132231404, 1.0, 3], "Inner156": [0.04855371900826447, -0.18076923076923077, 4], "Inner186": [-0.0873671782762692, 0.32527472527472495, 8], "Inner341": [0.013314967860422359, -0.04957264957264961, 9], "Inner118": [-0.26859504132231404, 1.0, 2], "Inner360": [-0.03794139744552968, 0.14125874125874185, 11], "Inner176": [-0.26859504132231404, 1.0, 2], "Inner168": [-0.26859504132231404, 1.0, 2], "Inner267": [-0.26859504132231404, 1.0, 4], "Inner355": [-0.26859504132231404, 1.0, 5], "Inner408": [-0.09944903581267218, 0.3702564102564108, 16], "Inner458": [-0.1628787878787879, 0.6064102564102566, 38], "Inner466": [-0.14173553719008264, 0.5276923076923077, 52], "Inner483": [-0.18008841053238517, 0.6704830053667268, 74], "Inner485": [0.13916765053128688, -0.5181318681318683, 242], "Inner486": [0.01786190349240198, -0.06650124069478909, 345], "Inner487": [0.01267716240978268, -0.04719805081796054, 350], "Inner183": [-0.26859504132231404, -3.7230769230769245, 2], "Inner32": [-0.26859504132231404, -3.7230769230769245, 2], "Inner53": [-0.26859504132231404, -3.7230769230769245, 2], "Inner182": [-0.26859504132231404, -3.7230769230769245, 4], "Inner392": [-0.26859504132231404, -3.7230769230769245, 6], "Inner18": [-0.26859504132231404, 1.0, 2], "Inner48": [-0.26859504132231404, 1.0, 3], "Inner244": [-0.26859504132231404, 1.0, 4], "Inner27": [-0.26859504132231404, -3.7230769230769245, 2], "Inner5": [-0.26859504132231404, -3.7230769230769245, 2], "Inner76": [-0.26859504132231404, -3.7230769230769245, 3], "Inner213": [-0.26859504132231404, -3.7230769230769245, 5], "Inner3": [-0.26859504132231404, -3.7230769230769245, 2], "Inner6": [-0.26859504132231404, -3.7230769230769245, 3], "Inner8": [-0.26859504132231404, -3.7230769230769245, 2], "Inner42": [-0.26859504132231404, -3.7230769230769245, 3], "Inner83": [-0.26859504132231404, -3.7230769230769245, 6], "Inner334": [-0.26859504132231404, -3.7230769230769245, 11], "Inner417": [-0.26859504132231404, 1.0, 15], "Inner424": [-0.26859504132231404, 1.0, 16], "Inner10": [-0.26859504132231404, -3.7230769230769245, 2], "Inner9": [-0.26859504132231404, -3.7230769230769245, 2], "Inner12": [-0.26859504132231404, -3.7230769230769245, 4], "Inner33": [-0.26859504132231404, -3.7230769230769245, 2], "Inner4": [-0.26859504132231404, -3.7230769230769245, 2], "Inner46": [-0.26859504132231404, -3.7230769230769245, 3], "Inner117": [-0.26859504132231404, -3.7230769230769245, 5], "Inner1": [-0.26859504132231404, -3.7230769230769245, 2], "Inner2": [-0.26859504132231404, 1.0, 2], "Inner7": [-0.26859504132231404, 1.0, 3], "Inner29": [-0.26859504132231404, 1.0, 5], "Inner155": [-0.26859504132231404, 1.0, 6], "Inner221": [-0.26859504132231404, 1.0, 11], "Inner257": [-0.26859504132231404, 1.0, 15], "Inner432": [-0.26859504132231404, 1.0, 31], "Inner464": [-0.26859504132231404, 1.0, 37], "Inner23": [-0.26859504132231404, 1.0, 2], "Inner72": [-0.26859504132231404, 1.0, 2], "Inner115": [-0.26859504132231404, 1.0, 3], "Inner44": [-0.26859504132231404, 1.0, 2], "Inner49": [-0.26859504132231404, 1.0, 3], "Inner77": [-0.26859504132231404, 1.0, 4], "Inner150": [-0.26859504132231404, 1.0, 7], "Inner192": [-0.26859504132231404, 1.0, 8], "Inner224": [-0.26859504132231404, 1.0, 10], "Inner265": [-0.26859504132231404, 1.0, 11], "Inner253": [-0.26859504132231404, -3.7230769230769245, 2], "Inner188": [-0.26859504132231404, 1.0, 2], "Inner207": [-0.26859504132231404, 1.0, 3], "Inner239": [-0.26859504132231404, 1.0, 4], "Inner328": [-0.26859504132231404, 1.0, 5], "Inner26": [-0.26859504132231404, -3.7230769230769245, 2], "Inner256": [-0.26859504132231404, -3.7230769230769245, 3], "Inner149": [-0.26859504132231404, 1.0, 2], "Inner181": [-0.26859504132231404, 1.0, 3], "Inner39": [-0.26859504132231404, 1.0, 2], "Inner209": [0.15426997245179055, -0.5743589743589751, 3], "Inner229": [-0.014876033057851235, 0.055384615384615386, 6], "Inner303": [-0.014876033057851235, 0.055384615384615386, 7], "Inner326": [-0.014876033057851235, 0.055384615384615386, 10], "Inner379": [-0.057162534435261744, 0.2128205128205131, 11], "Inner409": [-0.15326821938392185, 0.5706293706293709, 16], "Inner442": [-0.15326821938392185, 0.5706293706293709, 18], "Inner14": [-0.26859504132231404, 1.0, 2], "Inner306": [-0.26859504132231404, 1.0, 3], "Inner109": [0.365702479338843, -1.3615384615384623, 2], "Inner208": [0.15426997245179055, -0.5743589743589751, 3], "Inner300": [0.365702479338843, -1.3615384615384623, 4], "Inner146": [1.0, -3.7230769230769245, 2], "Inner333": [0.5771349862258952, -2.14871794871795, 6], "Inner388": [0.365702479338843, -1.3615384615384623, 9], "Inner34": [1.0, -3.7230769230769245, 2], "Inner71": [1.0, -3.7230769230769245, 3], "Inner105": [-0.26859504132231404, 1.0, 2], "Inner110": [0.15426997245179055, -0.5743589743589751, 3], "Inner205": [0.04855371900826447, -0.18076923076923077, 4], "Inner222": [0.23884297520661157, -0.8892307692307696, 5], "Inner251": [0.5242768595041322, -1.951923076923078, 8], "Inner395": [0.4449896694214875, -1.6567307692307702, 17], "Inner226": [-0.26859504132231404, 1.0, 2], "Inner376": [-0.26859504132231404, 1.0, 3], "Inner243": [0.365702479338843, -1.3615384615384623, 2], "Inner223": [-0.26859504132231404, 1.0, 2], "Inner252": [0.15426997245179055, -0.5743589743589751, 3], "Inner266": [0.23884297520661157, -0.8892307692307696, 5], "Inner232": [0.365702479338843, -1.3615384615384623, 2], "Inner238": [0.15426997245179055, -0.5743589743589751, 3], "Inner187": [-0.26859504132231404, 1.0, 2], "Inner299": [0.04855371900826447, -0.18076923076923077, 5], "Inner321": [0.15426997245179055, -0.5743589743589751, 10], "Inner365": [0.15426997245179055, -0.5743589743589751, 11], "Inner429": [0.04855371900826447, -0.18076923076923077, 14], "Inner443": [0.27508854781582054, -1.0241758241758248, 31], "Inner447": [0.15426997245179055, -0.5743589743589751, 49], "Inner471": [0.07498278236914598, -0.27916666666666684, 60], "Inner474": [0.03680746862565039, -0.13703703703703704, 97], "Inner488": [0.01741547708489855, -0.06483916083916118, 447], "Inner489": [0.0032467532467532353, -0.012087912087912201, 491]}');

d3.text("2xb7_manning_blossum90_manning.nwk", function(error, life) {
  if (error) {
    
    console.log(error);
  throw error;
  }

  var root = d3.hierarchy(parseNewick(life), function(d) { return d.branchset; })
      .sum(function(d) { return d.branchset ? 0 : 1; })
      .sort(function(a, b) { return (a.value - b.value) || d3.ascending(a.data.length, b.data.length); });

  cluster(root);

  var input = d3.select("#show-length input").on("change", changed),
      timeout = setTimeout(function() { input.property("checked", false).each(changed); }, 2000);

  setRadius(root, root.data.length = 0, Math.log(innerRadius*1000)*100);//maxLength(root));
  setColor(root);

  var linkExtension = chart.append("g")
      .attr("class", "link-extensions")
    .selectAll("path")
    .data(root.links().filter(function(d) { return !d.target.children; }))
    .enter().append("path")
      .each(function(d) { d.target.linkExtensionNode = this; })
      .attr("d", linkExtensionConstant);

  var link = chart.append("g")
      .attr("class", "links")
    .selectAll("path")
    .data(root.links())
    .enter().append("path")
      .each(function(d) { d.target.linkNode = this; })
      .attr("id",function(d){return d.source.data.name; })
      .attr("d", linkConstant)
      .attr("stroke-width", function(d) { if(efjson.hasOwnProperty(d.target.data.name)) return 2.0*Math.log(efjson[d.target.data.name][2])})
      .attr("fill","white")
      .attr("stroke-linecap","round")
      .attr("stroke", function(d) { 
        if(efjson.hasOwnProperty(d.target.data.name)) {
          if(efjson[d.target.data.name][0]>efjson[d.target.data.name][1]) return efcolorActives(efjson[d.target.data.name][0]);
          else return efcolorInactives(efjson[d.target.data.name][1]);
          
        }
        else return d.target.color; });
/*        else return d.target.color; });
      .attr("stroke-width", function(d) { if(efjson.hasOwnProperty(d.target.data.name)) return efjson[d.target.data.name][0]})
      .attr("stroke", function(d) { if(efjson.hasOwnProperty(d.target.data.name)) return efcolor(efjson[d.target.data.name][0]);
        else return d.target.color; });*/

  chart.append("g")
      .attr("font-size", "6px")
    .selectAll("text")
    .data(root.leaves())
    .enter().append("text")
      .attr("dy", ".31em")
      .attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + (innerRadius + 4) + ",0)" + (d.x < 180 ? "" : "rotate(180)"); })
      .attr("text-anchor", function(d) { return d.x < 180 ? "start" : "end"; })
      .attr("id",function(d){return d.data.name.split("_")[3]; })
      .text(function(d) { return d.data.name.split("_")[3]; })
      .attr("fill",function(d){return color(d.data.name.split("_")[0]);})
      .on("mouseover", mouseovered(true))
      .on("mouseout", mouseovered(false));

  function changed() {
    clearTimeout(timeout);
    var t = d3.transition().duration(750);
    linkExtension.transition(t).attr("d", this.checked ? linkExtensionVariable : linkExtensionConstant);
    link.transition(t).attr("d", this.checked ? linkVariable : linkConstant);
  }

  function mouseovered(active) {
    return function(d) {
      d3.select(this).classed("label--active", active);
      d3.select(d.linkExtensionNode).classed("link-extension--active", active).each(moveToFront);
      do d3.select(d.linkNode).classed("link--active", active).each(moveToFront); while (d = d.parent);
    };
  }

  function moveToFront() {
    this.parentNode.appendChild(this);
  }
});

// Compute the maximum cumulative length of any node in the tree.
function maxLength(d) {
  return d.data.length + (d.children ? d3.max(d.children, maxLength) : 0);
}

// Set the radius of each node by recursively summing and scaling the distance from the root.
function setRadius(d, y0, k) {
  d.radius = (y0 += d.data.length) * k;
  if (d.children) d.children.forEach(function(d) { setRadius(d, y0, k); });
}

// Set the color of each node by recursively inheriting.
function setColor(d) {
  var name = d.data.name.split("_")[0];
  d.color = color.domain().indexOf(name) >= 0 ? color(name) : d.parent ? d.parent.color : null;
  if (d.children) d.children.forEach(setColor);
}

function linkVariable(d) {
  return linkStep(d.source.x, d.source.radius, d.target.x, d.target.radius);
}

function linkConstant(d) {
  return linkStep(d.source.x, d.source.y, d.target.x, d.target.y);
}

function linkExtensionVariable(d) {
  return linkStep(d.target.x, d.target.radius, d.target.x, innerRadius);
}

function linkExtensionConstant(d) {
  return linkStep(d.target.x, d.target.y, d.target.x, innerRadius);
}

// Like d3.svg.diagonal.radial, but with square corners.
function linkStep(startAngle, startRadius, endAngle, endRadius) {
  var c0 = Math.cos(startAngle = (startAngle - 90) / 180 * Math.PI),
      s0 = Math.sin(startAngle),
      c1 = Math.cos(endAngle = (endAngle - 90) / 180 * Math.PI),
      s1 = Math.sin(endAngle);
  return "M" + startRadius * c0 + "," + startRadius * s0
      + (endAngle === startAngle ? "" : "A" + startRadius + "," + startRadius + " 0 0 " + (endAngle > startAngle ? 1 : 0) + " " + startRadius * c1 + "," + startRadius * s1)
      + "L" + endRadius * c1 + "," + endRadius * s1;
}

function selectKinases(){

  var txtfield=document.getElementById("inactive");
 
 var values=txtfield.value.split("\n");
 for (var i=0;i< values.length;i++){
   name=values[i].split("_")[0];
   d3.selectAll("#"+name)
     .style('fill','#ff0000')
     .style('font-weight','bold')
     .style('font-size','5px');
   };
  var txtfield=document.getElementById("selection");
 
  var values=txtfield.value.split("\n");
  for (var i=0;i< values.length;i++){
    name=values[i].split("_")[0];
    d3.selectAll("#"+name)
      .style('fill','#00ff00')
      .style('font-weight','bold')
      .style('font-size','5px');
    };



  }


</script>